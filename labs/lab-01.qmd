---
title: "Lab 01"
format:
  revealjs:
    multiplex: true
    controls: true
    theme: [default, custom.scss]
    highlight-style: atom-one
    include-in-header:
    - file: mathjax-color.html
    slide-number: c
    math: mathjax
revealjs-plugins:
  - quiz
embed-resources: true
filters:
    - openlinksinnewpage
editor: 
  markdown: 
    wrap: 72
execute: 
  echo: true
---

```{r echo=FALSE}

#| label: setup
#| message: false
#| include: false

## Load packages, custom functions, and styles
source("custom-setup-styles.R")

# Color in math equations
# https://egallic.fr/Recherche/aide-memoire/quarto_equation_colors.html#colors-in-equations-with-revealjs
```

# Agenda {data-menu-title="Agenda" background-image="images/calendar.png" background-size="100px" background-repeat="repeat"}

-   Learning to Code
-   R & RStudio Workflow
-   Getting Started

# Learning objectives

By the end of the lab, you will be able to ...

-   setup a reproducible workflow using R and RStudio\
-   familiarize yourself with a dataset using R and RStudio\
-   create a reproducible report using Quarto\

# Learning to Code {.theme-section}

## Technology is fun!

<br>

::: {style="font-size: 90%"}
You're not just learning the statistical concepts in this course, but
how to produce the statistics. Analyzing data requires learning to use
new technology.

<br>

Learning statistical software to analyze data can be really fun. You get
to learn about real world social problems!
:::

## Technology is challenging!

:::: r-stack
::: {style="font-size: 90%"}
It can be frustrating.

<br>

When it feels like the technology is preventing you from getting to the
course content, take a deep breath, and **remember that building your
technology skills is part of this course.**
:::

![](images/01/bingo.png){.fragment fragment-index="1" width="85%"}
::::

::: notes
Replication using technology requires researchers to sometimes use
unfamiliar software, working on devices with unique environments and
settings.

There's even a bingo card of common errors (i.e. bugs) that new
statistical programmers will expect to experience.
:::

## Why am I making you learn something so frustrating?

<br>

Calculating the statistics by hand quickly gets cumbersome, time
consuming, and difficult.

<br>

Good social science is built on replication.

::: notes
You'll learn the statistical techniques using small sample sizes, but to
really understand the social world, datasets typically have 100s,
1,000s, even 100,000s of values.

It is impractical, and more prone to errors, for scientists to replicate
research by hand. Replication of statistical procedures helps catch
minor coding errors, highlights unusual decisions made by researchers,
inappropriate statistical techniques, and corrupted data.
:::

## Grappling

Learning to use statistical software necessitates
[grappling](https://www.edutopia.org/blog/4-tips-teaching-problem-solving-from-student-anna-pelletiere).

::: {style="color: #18BC9C; font-size: 90%; font-family: 'Shadows Into Light'"}
Grappling implies trying even before you fail the first time.

<br>

It‚Äôs thinking, ‚ÄúFirst, I‚Äôll work with it independently. Okay, I‚Äôm really
not understanding it. Let me go back to my notes. Okay, I have solved
for the first part of it. Now I have the second part of it. Okay, I got
the question wrong; let me try again. Maybe I can ask my peer now.‚Äù

<br>

Grappling is working hard to make sure you understand the problem fully,
and then using every resource at your fingertips to solve it.‚Äù
:::

::: notes
In this course, this means you'll put your active learning skills to
use. You, not your professor or TA, will work through encountered
problems. You, of course, will be supported and coached through the
entire process. Working with statistical software will become easier as
you build your skills in problem-solving errors. Unfortunately, it gets
increasingly difficult if you rely on others to solve the issue, as the
errors stack-up.
:::

##  {data-menu-title="Debugging"}

:::::: columns
:::: {.column width="25%"}
::: {style="font-size: 95%; font-family: 'Shadows Into Light'"}
Most statistical analyses happen not because the person is a math
genius, but because they persisted through the minefield of technical
issues by being [**excellent problem-solvers.**]{style="color: #18BC9C"}
:::
::::

::: {.column width="75%"}
![](images/01/debugging.png)
:::
::::::

::: notes
Get comfortable with making mistakes right now. Your code is not
expected to be perfect the first time. Remember, identifying and fixing
errors in your own code is such an inherent part of the process, there's
even a name for it: **debugging**.
:::

## Coding is mostly Googling

<br>

It is a misconception that the best statistical analysts sit down at
their computers and type code from memory.

<br>

Much of process of coding is copying code from somewhere else and
modifying it to fit your particular situation.

::: notes
Learning to analyze data with software requires a lot of practice and
attention to detail. It also requires a lot of time searching the
internet for help. Learning to identify the right words and phrases in a
Google search is part of building your coding skills.
:::

## When you get stuck...

[**...there are many options to get unstuck:**]{style="color: #18BC9C"}

::: {style="font-size: 70%"}
-   Review the slides. Pay very close attention to small details.
-   Try something else to see if you get a new error.
-   Use Google to search for possible answers or new explanations.
-   Watch a help video on YouTube on the topic.
-   Re-start your web-browser or device.
-   Try another web-browser or device.
-   Ask a peer. Or an advanced student.
-   Start or join a weekly study group.
-   Post the question on the class discussion board.
-   Email your TA
:::

::: notes
When none of these strategies fix the issue, it is time to ask for help.
:::

## Help in this class

[**Before requesting an individual meeting with a
TA:**]{style="color: #E74C3C"}

::: {style="font-size: 75%"}
-   Spend a sufficient amount of time working on it on your own.
-   Ask two of your peers.
-   Post the question on the class discussion board.
:::

[**When emailing:**]{style="color: #E74C3C"}

::: {style="font-size: 75%"}
-   Explain what troubleshooting steps you‚Äôve already taken.¬†
-   Report who you‚Äôve already asked for help.¬†
:::

::: notes
If none of these solve your problem, draft an email to your TA, with
detailed notes about the problem and the troubleshooting steps you've
already taken. You might be surprised how often even writing the problem
out in detail helps you find the answer on your own. Send your email if
you still need assistance.
:::

## Create a trail! {data-menu-title="Help & Replication"}

![](images/01/repro_ex.png "Loneliness on internet without an answer to a coding question")

::: notes
Use replication principles when asking for help. The best quantitative
researchers produce a trail for their code so that future researchers
can replicate their analysis.
:::

## Create a reproducible example

<br>

::: {style="color: #18BC9C; font-size: 150%; font-family: 'Shadows Into Light'"}
**Goal: Make someone else feel your pain!**
:::

::: {style="font-size: 80%"}
-   Assume others know nothing about your issue.¬†
-   Describe your steps to create the problem so that someone else can
    replicate it.¬†
-   This means clearly describing the issue and the steps you've already
    taken to solve it.¬†
:::

## Good etiquette

**Search for answers before posting your question.**\
[Let me google that for you.
üôÑ]{style="color: #18BC9C; font-family: 'Shadows Into Light'"}¬†

**Describe the problem.**\
["It doesn't work" isn't descriptive
enough.]{style="color: #18BC9C; font-family: 'Shadows Into Light'"}¬†

**Describe your environment.**\
[What operating system are you using? Which R version? What packages?
Dataset?]{style="color: #18BC9C; font-family: 'Shadows Into Light'"}\

**Describe the solution.**\
[Confirm if a solution offered works. Or, if you solve it on your own,
post how you solved
it.]{style="color: #18BC9C; font-family: 'Shadows Into Light'"}

##  {data-menu-title="Process Focused" background-image="images/01/debug-flow.png" background-size="contain"}

::: notes
Try to stay focused on being in the process, not the outcome.
:::

# R & RStudio Workflow {.theme-section}

## Replication

[**The guiding principle for workflow.**]{style="color: #18BC9C"}

A workflow of data analysis is a process for managing all aspects of
data analysis.

<br>

Planning, documenting, and organizing your work; cleaning the data;
creating, renaming, and verifying variables; performing and presenting
statistical analyses; producing replicable results; and archiving what
you have done are all integral parts of your workflow.

::: aside
Source: (Long 2008)
:::

## Steps in a workflow

|  |  |
|-------------------------------|-----------------------------------------|
| **Set up** | Systematic organization of the project and project files. |
| **Familiarize self with data** | Skipping takes more time in the long run. |
| **Process data** | Takes the [**MOST**]{style="color: #e74c3c;"} time. |
| **Running analyses** | What people **THINK** takes the most time. |
| **Presenting results** | What people (wrongly) think does not take time. |

## File types

There are many file types, but these are key to an R & RStudio workflow
(and likely new to you):

::: {style="font-size: 70%"}
| Extension | Description |
|--------------------------|----------------------------------------------|
| .Rproj | RStudio project file (keeps project settings). |
| .R | R scripts store a sequence of R commands (code) that can be run all at once or line by line. |
| .qmd | Quarto Markdown creates reproducible documents that contain a combination of text, code, and output. |
| .Rdata (or sometimes .rda) | These store and load R objects‚Äîlike data frames. |
:::

## File names

should be:

-   machine-readable
-   human-readable
-   play well with default-ordering

## RStudio Projects

<br>

Create a **RStudio project** for each data analysis project.

It supports an organized and reproducible workflow, cleanly separated
from all other projects that you are working on. Everything you need in
one place:

::: {style="font-size: 80%"}
-   local data files to load into RStudio.
-   scripts to edit or run in bits or as a whole.
-   Save your outputs (plots and cleaned data).
:::

::: notes
Source:
<https://docs.posit.co/ide/user/ide/get-started/#hello-rstudio-projects>
:::

## Filepaths {.smaller}

Adopting a project-based workflow avoids changing file paths.

<br>

::::: columns
::: {.column width="60%"}
**ABSOLUTE FILE PATHS**

Department of Sociology\
Unit 17100, 17th Floor, Ontario Power Building\
700 University Ave., Toronto, ON M5G 1Z5

[`C:\Users\Pepin\GitHub\SOC6302\scripts`]{style="color: #fd7e14"}
:::

::: {.column width="40%"}
**RELATIVE FILE PATHS**

Take the left side elevators to the 17th floor.\
Go through the double doors and a take a right.\
First door on your left.

[**here(scripts)**]{style="color: #20c997"}
:::
:::::

## Panes

::::: r-stack
:::: {style="font-size: 80%"}
There are four key regions or ‚Äúpanes‚Äù in the interface:

1.  [**Source
    pane:**](https://docs.posit.co/ide/user/ide/guide/ui/ui-panes.html#source)
    where you can edit and save R scripts or author computational
    documents like Quarto and R Markdown.

2.  [**Console
    pane:**](https://docs.posit.co/ide/user/ide/guide/ui/ui-panes.html#console)
    is used to write short interactive R commands.

3.  [**Environment
    pane:**](https://docs.posit.co/ide/user/ide/guide/ui/ui-panes.html#environment-pane)
    displays temporary R objects created during that R session.

4.  [**Output
    pane:**](https://docs.posit.co/ide/user/ide/guide/ui/ui-panes.html#output-pane)
    displays the plots, tables, or HTML outputs of executed code along
    with files saved to disk.

::: {.callout-tip icon="false"}
## {{< fa pen-to-square >}} Source Pane

The top-left panel and can be launched by opening any editable file in
RStudio.
:::
::::

![](images/01/panes.png){.fragment fragment-index="1"}
:::::

::: notes
Console pane: best for exploring.\
Source pane: best for documenting.
:::

## Quarto

Quarto: The tool you'll use to create reproducible computational
documents. Every piece of assignment you hand in will be a Quarto
document.

::: callout-note
You are likely familiar with word processors like MS Word or Google
Docs. We will not be using these in this class. Instead, the words you
would write in such a document, as well as your R code, will go into a
Quarto document. You will *render* the document (more on what this means
later) to get a document out that has your words, code, and the output
of that code. Everything in one place, beautifully formatted!
:::

##  {#slide28-id data-menu-title="RScript vs Quarto"}

::::: columns
::: {.column width="50%"}
### [RScript]{style="color: #18BC9C;"}

great for learning, exploring and tinkering.

rerun it without attention to formatting or markdown.
:::

::: {.column width="50%"}
### [Quarto]{style="color: #18BC9C;"}

great for communicating analysis and results

combines narrative explanation with code output (results.
:::
:::::

## Documentation

::: r-stack
![](images/01/documentation.png)

![](images/01/pound.png){.fragment fragment-index="1"}
:::

::: notes
In .R scripts and Quarto, you can document your code. Err on the side of
over documentation. Your future self will thank you. In .R scripts, the
way to make a comment rather than a command, is to put a pound sign in
front of the text.
:::

## Blank slate

:::: r-stack
::: {style="font-size: 80%"}
Clear the memory at every restart of RStudio by turning off the
automatic saving of your workspace and .Rdata files with you quit
RStudio. This is important for reproducibility, debugging, and avoiding
littering your computer with unnecessary files.

Set this via:

1.  [Tools \> Global Options]{style="color: #3498DB"}.
2.  [Uncheck ‚ÄúRestore .RData into Workspace at
    Startup‚Äù]{style="color: #3498DB"}.
3.  Choose "[Never]{style="color: #3498DB"}" on the ‚ÄúSave workspace to
    .RData on exit‚Äù.
4.  Click "[Apply]{style="color: #3498DB"}" and
    "[OK]{style="color: #3498DB"}".
:::

![](images/01/blank-slate.png){.fragment fragment-index="1" width="45%"}
::::

## Comprehensive R Archive Network (CRAN)

CRAN is like an App Store for R. It hosts R packages, documentation, and
source code contributed by users worldwide. It is mediated (e.g.,
quality controlled), making it incredibly reliable.

R users can easily install, update, and share R packages using
`install.packages()`.

## Packages

R comes with basic tools, but **packages** extend the capabilities of
base R (what you already installed). An R package is like a toolbox: a
collection of functions, data, and documentation that help you do
specific tasks using R.

<br>

::: {style="font-size: 70%"}
You'll install each package (only once per system):
:::

```{r}
#| label: install-ex
#| message: false

install.packages("tidyverse")
```

<br>

::: {style="font-size: 70%"}
You'll load each package (every time you use it):
:::

```{r}
#| label: load-ex
#| message: false

library(tidyverse)
```

## Support

Some help videos and further explanation:

[R - Intro RStudio Interface](https://youtu.be/opy-v0WAHXM)

[EasyR - Getting started with R the easy
way](https://youtu.be/K9-zDmq737I)

# Getting Started {.theme-section}

## Your first code-along

Download and open [code-along-01]()

## Create a RStudio Project {#slideRStudioProj-id}

<br>

To create a new project in RStudio, click: [File \> New
Project]{style="color: #3498DB"}.

In the New Project wizard that pops up, select: [New Directory, then New
Project]{style="color: #3498DB"}.

Name the project ‚Äú[SOC6302]{style="color: #f39c12"}‚Äù and click: [Create
Project]{style="color: #3498DB"}.

This will launch you into a new RStudio Project inside a new folder
called ‚ÄúSOC6302‚Äù.

## R-script

Open RStudio, then click the dropdown arrow next to the "[New File
icon]{style="color: #3498DB"}," and then "[R
script]{style="color: #3498DB"}."

![](videos/01/R-script.mp4){width="65%"}

::: aside
Alternatively, hold down "Ctrl" + "Shift" + "N."
:::

::: notes
An R-script is a file that will contain the documentation of the code of
what you tell R to do.
:::

## Packages

We'll use the following packages:

-   `here()` (relative file paths)
-   `tidyverse()` (data wrangling)
-   `gssr()` (U.S. General Social Survey data)
-   `gssrdoc()` (GSS documentation)

## Install `here()` and `tidyverse()`

Let's install the two packages that are available on CRAN.

<br>

Copy and paste the following code into your Console pane. Then hit
enter.

```{r}
#| eval: false
#| message: false
#| label: install-here


install.packages("here")
```

<br>

Then, do the same to install the tidyverse package.

```{r}
#| eval: false
#| message: false
#| label: install-tidyverse

install.packages("tidyverse")
```

## Install `gssr()` and `gssrdoc()`

```{r}
#| eval: false
#| message: false
#| label: install-gss

# Install 'gssr' from 'ropensci' universe
install.packages('gssr', repos =
  c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))

# Also recommended: install 'gssrdoc' as well
install.packages('gssrdoc', repos =
  c('https://kjhealy.r-universe.dev', 'https://cloud.r-project.org'))
```

## Load the packages

```{r}
#| message: false
#| label: load

library(here)
library(tidyverse)
library(gssr)
library(gssrdoc)
```

## Environment

```{r}
#| message: false
#| label: enviro

# software documentation
sessionInfo()

```

## Project Structure

Let's set up your project structure using the `here()` package.

![](https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/here.png)

## `here()`

First, let's just establish our project directory

```{r}
#| message: false
#| label: here

# set the file path to the root of the project
here()

```

## Example Folder Structure {.smaller}

::::: columns
:::: {.column width="60%"}
**Research Projects**

<div class="file-tree">
  <details open>
    <summary>project/</summary>

    <details>
      <summary>data/</summary>
      <div>gss7924-raw.rda</div>
      <div>gss7924-processed.Rdata/</div>
    </details>

    <details>
      <summary>scripts/</summary>
      <div>clean_data.R</div>
      <div>analyze_data.R</div>
      <div>draft.qmd</div>
    </details>

    <details>
      <summary>outputs/</summary>
        <div>draft.html</div>
      <details>
        <summary>figures/</summary>
        <div>plot1.png</div>
        <div>plot2.png</div>
      </details>
    </details>

    <div>readme.qmd</div>
    <div>project.Rproj</div>
  </details>
</div>

::::

:::: {.column width="40%"}
**SOC6302**

<div class="file-tree">
  <details open>
    <summary>SOC6302/</summary>

    <details>
      <summary>data/</summary>
      <div>gss7924-raw.rda</div>
      <div>gss7924-processed.Rdata/</div>
    </details>
    
    <details>
      <summary>code-alongs/</summary>
    </details>
    
    <details>
      <summary>milestones/</summary>
    </details>

    <details>
      <summary>project/</summary>
        <details>
          <summary>data/</summary>
        </details>
        <details>
          <summary>scripts/</summary>
        </details>
        <details>
          <summary>outputs/</summary>
        </details>
    </details>

    <div>readme.qmd</div>
    <div>SOC6302.Rproj</div>

  </details>
</div>


::::
:::::

## Create a Folder Structure 
with `here()` and `dir.create()`

```{r}
#| eval: false
#| message: false
#| label: base-folders

# Create base folders
dir.create(here("data"), recursive = TRUE)
dir.create(here("code-alongs"), recursive = TRUE)
dir.create(here("milestones"), recursive = TRUE)
dir.create(here("project"), recursive = TRUE)
```

## Create Sub-folders
with `here()` and `dir.create()`

```{r}
#| eval: false
#| message: false
#| label: sub-folders

# Create project sub-folders
dir.create(here("project", "data"), recursive = TRUE)
dir.create(here("project", "scripts"), recursive = TRUE)
dir.create(here("project", "outputs"), recursive = TRUE)

```


# Check your work

```{r}
# Your SOC6302 class folder
list.files(path = here())

# Your "Project" sub-folder
list.files(path = here("project"))

```

## Save code-along into correct folder

ggsave(here("code-alongs"),code-along-01.qmd)


# YAML

YAML Ain't Markup Language
